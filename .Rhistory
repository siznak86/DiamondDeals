# Mediation analysis
mediator_models <- step_model_ERA(
mediator_model_1 = AGE ~ WAR,
mediator_model_2 = IP ~ WAR,
mediator_model_3 = ERA ~ WAR,
mediator_model_4 = WHIP ~ WAR,
mediator_model_5 = W ~ WAR,
mediator_model_6 = SV ~ WAR
)
# Step wise Exponential regression
step_model_ERA <- step(lm(log(`AVG. SALARY`) ~ AGE + IP + ERA + WHIP + W + SV + WAR, data = FreeAgencyERA), direction = "both")
summary(step_model_ERA)
# Mediation analysis
mediator_models <- step_model_ERA(
mediator_model_1 = AGE ~ WAR,
mediator_model_2 = IP ~ WAR,
mediator_model_3 = ERA ~ WAR,
mediator_model_4 = WHIP ~ WAR,
mediator_model_5 = W ~ WAR,
mediator_model_6 = SV ~ WAR
)
# Mediation analysis
mediation_results <- mediate(step_model_ERA, mediator = ~ AGE + IP + ERA + WHIP + W + SV, treat = "WAR")
summary(mediation_results)
# Mediation analysis
mediation_results <- mediate(lm(log(`AVG. SALARY`) ~ AGE + IP + ERA + WHIP + W + SV + WAR, data = FreeAgencyERA), mediator = ~ AGE + IP + ERA + WHIP + W + SV, treat = "WAR")
# Mediation analysis
model_ERA <- lm(log(`AVG. SALARY`) ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = FreeAgencyERA)
mediation_results <- mediate(model_ERA, mediator = ~ AGE + IP + ERA + WHIP + W + SV, treat = "WAR")
mediation_results <- mediate(model_ERA, mediator = WAR ~ AGE + IP + ERA + WHIP + W + SV, treat = "WAR")
# Mediation analysis
model_ERA <- lm(log(`AVG. SALARY`) ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = FreeAgencyERA)
mediation_results <- mediate(model_ERA, mediator = WAR ~ AGE + IP + ERA + WHIP + W + SV, treat = "WAR")
mediation_model_ERA_AGE <- lm(AGE ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_AGE <- lm(log(`AVG. SALARY`) ~ WAR + AGE, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
mediation_model_ERA_AGE <- lm(AGE ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_AGE <- lm(log(`AVG. SALARY`) ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
data_for_mediation <- FreeAgencyERA[c("AVG. SALARY", "WAR", "AGE")]
View(data_for_mediation)
# Specify the mediation model
mediation_model <- lm(AGE ~ WAR, data = data_for_mediation)
# Specify the outcome model
outcome_model <- lm(log(`AVG. SALARY`) ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = FreeAgencyERA)
# Run mediation analysis with bootstrapping
med_boot <- mediate(mediation_model, outcome_model, treat = "WAR", mediator = "AGE", boot = TRUE, sims = 1000)
summary(med_boot)
data_for_mediation <- FreeAgencyERA[c("AVG. SALARY", "WAR", "AGE")]
data_for_mediation$log_AVG_SALARY <- log(data_for_mediation$`AVG. SALARY`)
View(data_for_mediation)
# Specify the mediation model
mediation_model <- lm(AGE ~ WAR, data = data_for_mediation)
mediation_model <- lm(AGE ~ WAR, data = data_for_mediation)
# Specify the outcome model
outcome_model <- lm(log_AVG_SALARY ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = data_for_mediation)
# Specify the outcome model
outcome_model <- lm(log_AVG_SALARY ~ WAR + AGE, data = data_for_mediation)
# Run mediation analysis with bootstrapping
med_boot <- mediate(mediation_model, outcome_model, treat = "WAR", mediator = "AGE", boot = TRUE, sims = 1000)
summary(med_boot)
# Mediator(AGE) IV(WAR) DV(AVG. SALRARY) Control()
FreeAgencyERA$log_AVG_SALARY <- log(data_for_mediation$`AVG. SALARY`)
mediation_model_ERA_AGE <- lm(AGE ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_AGE <- lm(log(`AVG. SALARY`) ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
outcome_model_ERA_AGE <- lm(log_AVG_SALARY ~ WAR + AGE + IP + ERA + WHIP + W + SV, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
summary(mediation_model_ERA_AGE)
summary(mediate_model_ERA_AGE)
# Mediator(AGE) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_AGE <- lm(AGE ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_AGE <- lm(log_AVG_SALARY ~ WAR + AGE, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
summary(mediation_model_ERA_AGE)
summary(mediate_model_ERA_AGE)
# Mediator(ERA) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_ERA <- lm(ERA ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_ERA <- lm(log_AVG_SALARY ~ WAR + ERA, data = FreeAgencyERA)
mediate_model_ERA_ERA <- mediate(mediation_model_ERA_ERA, outcome_model_ERA_ERA, treat = "WAR", mediator = "ERA", boot = TRUE)
summary(mediation_model_ERA_ERA)
summary(mediate_model_ERA_ERA)
# Mediator(WHIP) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_WHIP <- lm(WHIP ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_WHIP <- lm(log_AVG_SALARY ~ WAR + WHIP, data = FreeAgencyERA)
mediate_model_ERA_WHIP <- mediate(mediation_model_ERA_WHIP, outcome_model_ERA_WHIP, treat = "WAR", mediator = "WHIP", boot = TRUE)
summary(mediation_model_ERA_WHIP)
summary(mediate_model_ERA_WHIP)
# Mediator(W) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_W <- lm(W ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_W <- lm(log_AVG_SALARY ~ WAR + W, data = FreeAgencyERA)
mediate_model_ERA_W <- mediate(mediation_model_ERA_W, outcome_model_ERA_W, treat = "WAR", mediator = "W", boot = TRUE)
summary(mediation_model_ERA_W)
summary(mediate_model_ERA_W)
# Mediator(SV) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_SV <- lm(SV ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_SV <- lm(log_AVG_SALARY ~ WAR + SV, data = FreeAgencyERA)
mediate_model_ERA_SV <- mediate(mediation_model_ERA_SV, outcome_model_ERA_SV, treat = "WAR", mediator = "SV", boot = TRUE)
summary(mediation_model_ERA_SV)
summary(mediate_model_ERA_SV)
# Mediator(IP) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_ERA <- lm(IP ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_ERA <- lm(log_AVG_SALARY ~ WAR + IP, data = FreeAgencyERA)
# Mediator(IP) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_IP <- lm(IP ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_IP <- lm(log_AVG_SALARY ~ WAR + IP, data = FreeAgencyERA)
mediate_model_ERA_IP <- mediate(mediation_model_ERA_ERA, outcome_model_ERA_ERA, treat = "WAR", mediator = "IP", boot = TRUE)
summary(mediation_model_ERA_IP)
summary(mediate_model_ERA_IP)
# Mediator(IP) IV(WAR) DV(AVG. SALRARY) Control()
mediation_model_ERA_IP <- lm(IP ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_IP <- lm(log_AVG_SALARY ~ WAR + IP, data = FreeAgencyERA)
mediate_model_ERA_IP <- mediate(mediation_model_ERA_ERA, outcome_model_ERA_ERA, treat = "WAR", mediator = "IP", boot = TRUE)
summary(mediation_model_ERA_IP)
summary(mediate_model_ERA_IP)
# Significant p = 2e-16
# Mediator(WHIP) IV(WAR) DV(AVG. SALARY) Control()
mediation_model_ERA_WHIP <- lm(WHIP ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_WHIP <- lm(log_AVG_SALARY ~ WAR + WHIP, data = FreeAgencyERA)
mediate_model_ERA_WHIP <- mediate(mediation_model_ERA_WHIP, outcome_model_ERA_WHIP, treat = "WAR", mediator = "WHIP", boot = TRUE)
summary(mediation_model_ERA_WHIP)
summary(mediate_model_ERA_WHIP)
# Mediator(W) IV(WAR) DV(AVG. SALARY) Control()
mediation_model_ERA_W <- lm(W ~ WAR, data = FreeAgencyERA)
outcome_model_ERA_W <- lm(log_AVG_SALARY ~ WAR + W, data = FreeAgencyERA)
mediate_model_ERA_W <- mediate(mediation_model_ERA_W, outcome_model_ERA_W, treat = "WAR", mediator = "W", boot = TRUE)
summary(mediation_model_ERA_W)
summary(mediate_model_ERA_W)
# Moderator(AGE) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_AGE <- lm(log(`AVG. SALARY`) ~ WAR * AGE, data = FreeAgencyERA)
summary(moderation_model_ERA_AGE)
# Moderator(IP) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_IP <- lm(log(`AVG. SALARY`) ~ WAR * IP, data = FreeAgencyERA)
summary(moderation_model_ERA_IP)
# Moderator(ERA) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_ERA <- lm(log(`AVG. SALARY`) ~ WAR * ERA, data = FreeAgencyERA)
summary(moderation_model_ERA_ERA)
# Moderator(WHIP) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_WHIP <- lm(log(`AVG. SALARY`) ~ WAR * WHIP, data = FreeAgencyERA)
summary(moderation_model_ERA_WHIP)
# Moderator(W) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_W <- lm(log(`AVG. SALARY`) ~ WAR * W, data = FreeAgencyERA)
summary(moderation_model_ERA_W)
# Moderator(SV) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_SV <- lm(log(`AVG. SALARY`) ~ WAR * SV, data = FreeAgencyERA)
summary(moderation_model_ERA_SV)
FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277) * exp(-0.023938*FreeAgencyERA_Results$AGE) * exp(0.004216*FreeAgencyERA_Results$IP) * exp(0.045483*FreeAgencyERA_Results$ERA) * exp(-0.721570*FreeAgencyERA_Results$WHIP) * exp(0.054429*FreeAgencyERA_Results$W) * exp(0.025936*FreeAgencyERA_Results$SV) * exp(0.154367*FreeAgencyERA_Results$WAR)
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Difference <- ((FreeAgencyERA_Results$Predicted_Salary - FreeAgencyERA_Results$`AVG. SALARY`)/FreeAgencyERA_Results$`AVG. SALARY`)
# Averge Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Standard Deviation
sd(FreeAgencyERA_Results$Model_Difference)
# Creating a Model
# ERA
# FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277) * exp(-0.023938*FreeAgencyERA_Results$AGE) * exp(0.004216*FreeAgencyERA_Results$IP) * exp(0.045483*FreeAgencyERA_Results$ERA) * exp(-0.721570*FreeAgencyERA_Results$WHIP) * exp(0.054429*FreeAgencyERA_Results$W) * exp(0.025936*FreeAgencyERA_Results$SV) * exp(0.154367*FreeAgencyERA_Results$WAR)
FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277 +  0.154367*FreeAgencyERA_Results$WAR - 0.023938*FreeAgencyERA_Results$AGE + 0.004216*FreeAgencyERA_Results$IP + 0.045483*FreeAgencyERA_Results$ERA - 0.721570*FreeAgencyERA_Results$WHIP + 0.054429*FreeAgencyERA_Results$W + 0.025936*FreeAgencyERA_Results$SV - 0.0012974*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$IP) - 0.01393*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$W)
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Difference <- ((FreeAgencyERA_Results$Predicted_Salary - FreeAgencyERA_Results$`AVG. SALARY`)/FreeAgencyERA_Results$`AVG. SALARY`)
# Averge Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Creating a Model
# ERA
# FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277) * exp(-0.023938*FreeAgencyERA_Results$AGE) * exp(0.004216*FreeAgencyERA_Results$IP) * exp(0.045483*FreeAgencyERA_Results$ERA) * exp(-0.721570*FreeAgencyERA_Results$WHIP) * exp(0.054429*FreeAgencyERA_Results$W) * exp(0.025936*FreeAgencyERA_Results$SV) * exp(0.154367*FreeAgencyERA_Results$WAR)
FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277 +  0.154367*FreeAgencyERA_Results$WAR - 0.023938*FreeAgencyERA_Results$AGE + 0.004216*FreeAgencyERA_Results$IP + 0.045483*FreeAgencyERA_Results$ERA - 0.721570*FreeAgencyERA_Results$WHIP + 0.054429*FreeAgencyERA_Results$W + 0.025936*FreeAgencyERA_Results$SV - 0.0012974*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$IP) - 0.01393*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$W))
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Difference <- ((FreeAgencyERA_Results$Predicted_Salary - FreeAgencyERA_Results$`AVG. SALARY`)/FreeAgencyERA_Results$`AVG. SALARY`)
# Averge Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Standard Deviation
sd(FreeAgencyERA_Results$Model_Difference)
# OPS
# Exponential Regression
step_model_OPS <- step(lm(log(`AVG. SALARY`) ~ AGE + H + RBI + HR + AVG + OPS + WAR, data = FreeAgencyOPS), direction = "both")
summary(step_model_OPS)
# Mediation analysis
FreeAgencyOPS$log_AVG_SALARY <- log(data_for_mediation$`AVG. SALARY`)
# Mediation analysis
FreeAgencyOPS$log_AVG_SALARY <- log(FreeAgencyOPS$`AVG. SALARY`)
# Mediation analysis
FreeAgencyERA$log_AVG_SALARY <- log(FreeAgencyERA$`AVG. SALARY`)
# Mediator(AGE) IV(WAR) DV(AVG. SALARY)
mediation_model_OPS_AGE <- lm(AGE ~ WAR, data = FreeAgencyOPS)
outcome_model_OPS_AGE <- lm(log_AVG_SALARY ~ WAR + AGE, data = FreeAgencyOPS)
mediate_model_OPS_AGE <- mediate(mediation_model_OPS_AGE, outcome_model_OPS_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
summary(mediation_model_OPS_AGE)
summary(mediate_model_OPS_AGE)
# Mediator(H) IV(WAR) DV(AVG. SALARY)
mediation_model_OPS_H <- lm(H ~ WAR, data = FreeAgencyOPS)
outcome_model_OPS_H <- lm(log_AVG_SALARY ~ WAR + H, data = FreeAgencyOPS)
mediate_model_OPS_H <- mediate(mediation_model_OPS_H, outcome_model_OPS_H, treat = "WAR", mediator = "H", boot = TRUE)
summary(mediation_model_OPS_H)
summary(mediate_model_OPS_H)
# Mediator(AVG) IV(WAR) DV(AVG. SALARY)
mediation_model_OPS_AVG <- lm(AVG ~ WAR, data = FreeAgencyOPS)
outcome_model_OPS_AVG <- lm(log_AVG_SALARY ~ WAR + AVG, data = FreeAgencyOPS)
mediate_model_OPS_AVG <- mediate(mediation_model_OPS_AVG, outcome_model_OPS_AVG, treat = "WAR", mediator = "AVG", boot = TRUE)
summary(mediation_model_OPS_AVG)
summary(mediate_model_OPS_AVG)
# Mediator(OPS) IV(WAR) DV(AVG. SALARY)
mediation_model_OPS_OPS <- lm(OPS ~ WAR, data = FreeAgencyOPS)
outcome_model_OPS_OPS <- lm(log_AVG_SALARY ~ WAR + OPS, data = FreeAgencyOPS)
mediate_model_OPS_OPS <- mediate(mediation_model_OPS_OPS, outcome_model_OPS_OPS, treat = "WAR", mediator = "OPS", boot = TRUE)
summary(mediation_model_OPS_OPS)
summary(mediate_model_OPS_OPS)
# Moderation analysis
# Moderator(AGE) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_AGE <- lm(log(`AVG. SALARY`) ~ WAR * AGE, data = FreeAgencyOPS)
summary(moderation_model_OPS_AGE)
# Moderator(H) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_H <- lm(log(`AVG. SALARY`) ~ WAR * H, data = FreeAgencyOPS)
summary(moderation_model_OPS_H)
# Moderator(AVG) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_AVG <- lm(log(`AVG. SALARY`) ~ WAR * AVG, data = FreeAgencyOPS)
summary(moderation_model_OPS_AVG)
# Moderator(OPS) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_OPS <- lm(log(`AVG. SALARY`)` ~ WAR * OPS, data = FreeAgencyOPS)
summary(moderation_model_OPS_OPS)
# Moderator(OPS) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_OPS <- lm(log(`AVG. SALARY`) ~ WAR * OPS, data = FreeAgencyOPS)
summary(moderation_model_OPS_OPS)
# OPS
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269) * exp(-0.022076*FreeAgencyOPS_Results$AGE) * exp(0.008152*FreeAgencyOPS_Results$H) * exp(-6.927712*FreeAgencyOPS_Results$AVG) * exp(3.627472*FreeAgencyOPS_Results$OPS) * exp(0.215630*FreeAgencyOPS_Results$WAR)
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Difference <- ((FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Averge Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation
sd(FreeAgencyOPS_Results$Model_Difference)
# OPS
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (H Coefficient * H) + (AVG Coefficient * AVG) + (OPS Coefficient * OPS) + (WAR:H Moderation Coefficient * (WAR * H)) + (WAR:OPS Moderation Coefficient * (WAR * OPS)))
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269 + 0.215630*FreeAgencyOPS_Results$WAR - 0.022076*FreeAgencyOPS_Results$AGE + 0.008152*FreeAgencyOPS_Results$H - 6.927712*FreeAgencyOPS_Results$AVG + 3.627472*FreeAgencyOPS_Results$OPS - 0.0018766*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$H) + 4233340*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$OPS))
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Difference <- ((FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Averge Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation
sd(FreeAgencyOPS_Results$Model_Difference)
# Moderator(OPS) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_OPS <- lm(log(`AVG. SALARY`) ~ WAR * OPS, data = FreeAgencyOPS)
summary(moderation_model_OPS_OPS)
# Moderator(OPS) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_OPS <- lm(log(`AVG. SALARY`) ~ WAR * OPS, data = FreeAgencyOPS)
summary(moderation_model_OPS_OPS)
# OPS
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (H Coefficient * H) + (AVG Coefficient * AVG) + (OPS Coefficient * OPS) + (WAR:H Moderation Coefficient * (WAR * H)) + (WAR:OPS Moderation Coefficient * (WAR * OPS)))
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269 + 0.215630*FreeAgencyOPS_Results$WAR - 0.022076*FreeAgencyOPS_Results$AGE + 0.008152*FreeAgencyOPS_Results$H - 6.927712*FreeAgencyOPS_Results$AVG + 3.627472*FreeAgencyOPS_Results$OPS - 0.0018766*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$H))
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Difference <- ((FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Averge Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation
sd(FreeAgencyOPS_Results$Model_Difference)
## Saving Free Agency Results Data Set
write.csv(FreeAgencyERA_Results, "FreeAgencyERA_Results.csv", row.names = FALSE)
write.csv(FreeAgencyOPS_Results, "FreeAgencyOPS_Results.csv", row.names = FALSE)
# 1.051311
summary(FreeAgencyERA_Results$Model_Difference)
summary(FreeAgencyOPS_Results$Model_Difference)
mae <- mean(abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary))
mean(abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary))
mse <- mean((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)^2)
mean((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)^2)
rmse <- sqrt(mse)
sqrt(mse)
r_squared <- 1 - sum((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)^2) / sum((FreeAgencyOPS_Results$`AVG. SALARY` - mean(FreeAgencyOPS_Results$`AVG. SALARY`))^2)
r_squared <- 1 - sum((FreeAgencyOPS_Results$`AVG. SALARY`) - k - 1)
count(FreeAgencyOPS_Results$Predicted_Salary)
r_squared <- 1 - sum((FreeAgencyOPS_Results$`AVG. SALARY`) - 278 - 1)
# OPS
# Exponential Regression
step_model_OPS <- step(lm(log(`AVG. SALARY`) ~ AGE + H + RBI + HR + AVG + OPS + WAR, data = FreeAgencyOPS), direction = "both")
summary(step_model_OPS)
library(corrplot)
library(ggplot2)
library(ggplotify)
library(nnet)
library(mediation)
library(moderndive)
library(readxl)
library(interactions)
library(jtools)
library(forecast)
library(car)
# Percent Difference = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Change <- ((FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
# Averge Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation
sd(FreeAgencyOPS_Results$Model_Difference)
summary(FreeAgencyOPS_Results$Model_Difference)
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`)/FreeAgencyOPS_Results$`AVG. SALARY`)
drop2 <- c("POS.", "YRS", "DOLLARS", "YEAR","DummyPos", "PosNumber", "Model_Difference", "Model_Change", "Model_Error")
FreeAgencyOPS_Results = FreeAgencyOPS_Results[,!(names(FreeAgencyOPS_Results) %in% drop2)]
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$Predicted_Salary - FreeAgencyOPS_Results$`AVG. SALARY`) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
summary(FreeAgencyOPS_Results$Model_Error)
summary(FreeAgencyOPS_Results$Model_Difference)
# Average Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Difference)
# Dropping columns
## Dropping Erroneous Columns
drop1 <- c("POS.", "YRS", "DOLLARS", "YEAR", "DummyPos", "PosNumber", "Model_Difference")
FreeAgencyERA_Results = FreeAgencyERA_Results[,!(names(FreeAgencyERA_Results) %in% drop1)]
# Percent Error = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Error <- ((FreeAgencyERA_Results$Predicted_Salary - FreeAgencyERA_Results$`AVG. SALARY`)/FreeAgencyERA_Results$`AVG. SALARY`)
# Average Error
mean(FreeAgencyERA_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyERA_Results$Model_Error)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyERA_Results$Model_Difference <- abs(FreeAgencyERA_Results$Predicted_Salary - FreeAgencyERA_Results$`AVG. SALARY`) / ((FreeAgencyERA_Results$Predicted_Salary + FreeAgencyERA_Results$`AVG. SALARY`)/2)
summary(FreeAgencyERA_Results$Model_Error)
# Average Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Standard Deviation of Difference
sd(FreeAgencyERA_Results$Model_Difference)
## Saving Free Agency Results Data Set
write.csv(FreeAgencyERA_Results, "FreeAgencyERA_Results.csv", row.names = FALSE)
write.csv(FreeAgencyOPS_Results, "FreeAgencyOPS_Results.csv", row.names = FALSE)
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Average Error
mean(FreeAgencyOPS_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Error)
# Percent Error = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Error <- ((FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary)/FreeAgencyERA_Results$`AVG. SALARY`)
# Average Error
mean(FreeAgencyERA_Results$Model_Error)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyERA_Results$Model_Difference <- abs(FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary) / ((FreeAgencyERA_Results$Predicted_Salary + FreeAgencyERA_Results$`AVG. SALARY`)/2)
# Average Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Standard Deviation of Difference
sd(FreeAgencyERA_Results$Model_Difference)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
# Average Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Difference)
# Step wise Exponential regression
step_model_ERA <- step(lm(log(`AVG. SALARY`) ~ AGE + IP + ERA + WHIP + W + SV + WAR, data = FreeAgencyERA), direction = "both")
summary(step_model_ERA)
# Step wise Exponential regression
step_model_ERA <- step(lm((`AVG. SALARY`) ~ AGE + IP + ERA + WHIP + W + SV + WAR, data = FreeAgencyERA), direction = "both")
summary(step_model_ERA)
# Mediator(AGE) IV(WAR) DV(AVG. SALARY) Control()
mediation_model_ERA_AGE <- lm(AGE ~ WAR, data = FreeAgencyERA)
View(outcome_model_ERA_AGE)
outcome_model_ERA_AGE <- lm(`AVG. SALARY` ~ WAR + AGE, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
summary(mediate_model_ERA_AGE)
log_AVG_SALARY
outcome_model_ERA_AGE <- lm(log_AVG_SALARY ~ WAR + AGE, data = FreeAgencyERA)
mediate_model_ERA_AGE <- mediate(mediation_model_ERA_AGE, outcome_model_ERA_AGE, treat = "WAR", mediator = "AGE", boot = TRUE)
summary(mediate_model_ERA_AGE)
# Moderation analysis
# Moderator(AGE) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_AGE <- lm((`AVG. SALARY`) ~ WAR * AGE, data = FreeAgencyERA)
summary(moderation_model_ERA_AGE)
# Moderator(IP) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_IP <- lm((`AVG. SALARY`) ~ WAR * IP, data = FreeAgencyERA)
summary(moderation_model_ERA_IP)
# Moderator(ERA) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_ERA <- lm((`AVG. SALARY`) ~ WAR * ERA, data = FreeAgencyERA)
summary(moderation_model_ERA_ERA)
# Moderator(WHIP) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_WHIP <- lm((`AVG. SALARY`) ~ WAR * WHIP, data = FreeAgencyERA)
summary(moderation_model_ERA_WHIP)
# Moderator(W) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_W <- lm((`AVG. SALARY`) ~ WAR * W, data = FreeAgencyERA)
summary(moderation_model_ERA_W)
# Moderator(SV) IV(WAR) DV(AVG. SALARY)
moderation_model_ERA_SV <- lm((`AVG. SALARY`) ~ WAR * SV, data = FreeAgencyERA)
summary(moderation_model_ERA_SV)
# Creating a Model
# ERA
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (IP Coefficient * IP) + (ERA Coefficient * ERA) + (WHIP Coefficient * WHIP) + (W Coefficient * W) + (SV Coefficient * SV) + (WAR:IP Moderation Coefficient * (WAR * IP)) + (WAR:W Moderation Coefficient * (WAR * W)))
#FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277 +  0.154367*FreeAgencyERA_Results$WAR - 0.023938*FreeAgencyERA_Results$AGE + 0.004216*FreeAgencyERA_Results$IP + 0.045483*FreeAgencyERA_Results$ERA - 0.721570*FreeAgencyERA_Results$WHIP + 0.054429*FreeAgencyERA_Results$W + 0.025936*FreeAgencyERA_Results$SV - 0.0012974*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$IP) - 0.01393*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$W))
FreeAgencyERA_Results$Predicted_Salary <- 15901686 -284546*FreeAgencyERA_Results$AGE + 724465*FreeAgencyERA_Results$ERA - 5699905*FreeAgencyERA_Results$WHIP + 533834*FreeAgencyERA_Results$W + 93039*FreeAgencyERA_Results$SV + 2310227*FreeAgencyERA_Results$WAR + 9749*FreeAgencyERA_Results$WAR*FreeAgencyERA_Results$IP - 4334535*FreeAgencyERA_Results$WAR*FreeAgencyERA_Results$WHIP + 142080*FreeAgencyERA_Results$WAR*FreeAgencyERA_Results$W
# Percent Error = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Error <- ((FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary)/FreeAgencyERA_Results$`AVG. SALARY`)
# Average Error
mean(FreeAgencyERA_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyERA_Results$Model_Error)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyERA_Results$Model_Difference <- abs(FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary) / ((FreeAgencyERA_Results$Predicted_Salary + FreeAgencyERA_Results$`AVG. SALARY`)/2)
# Average Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Creating a Model
# ERA
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (IP Coefficient * IP) + (ERA Coefficient * ERA) + (WHIP Coefficient * WHIP) + (W Coefficient * W) + (SV Coefficient * SV) + (WAR:IP Moderation Coefficient * (WAR * IP)) + (WAR:W Moderation Coefficient * (WAR * W)))
FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277 +  0.154367*FreeAgencyERA_Results$WAR - 0.023938*FreeAgencyERA_Results$AGE + 0.004216*FreeAgencyERA_Results$IP + 0.045483*FreeAgencyERA_Results$ERA - 0.721570*FreeAgencyERA_Results$WHIP + 0.054429*FreeAgencyERA_Results$W + 0.025936*FreeAgencyERA_Results$SV - 0.0012974*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$IP) - 0.01393*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$W))
# Percent Error = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Error <- ((FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary)/FreeAgencyERA_Results$`AVG. SALARY`)
# Average Error
mean(FreeAgencyERA_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyERA_Results$Model_Error)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyERA_Results$Model_Difference <- abs(FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary) / ((FreeAgencyERA_Results$Predicted_Salary + FreeAgencyERA_Results$`AVG. SALARY`)/2)
# Average Difference
mean(FreeAgencyERA_Results$Model_Difference)
# Standard Deviation of Difference
sd(FreeAgencyERA_Results$Model_Difference)
moderation_model_OPS_HR <- lm(log(`AVG. SALARY`) ~ WAR * HR, data = FreeAgencyOPS)
summary(moderation_model_OPS_HR)
moderation_model_OPS_RBI <- lm(log(`AVG. SALARY`) ~ WAR * RBI, data = FreeAgencyOPS)
summary(moderation_model_OPS_RBI)
# OPS
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (H Coefficient * H) + (AVG Coefficient * AVG) + (OPS Coefficient * OPS) + (WAR:H Moderation Coefficient * (WAR * H)) + (WAR:OPS Moderation Coefficient * (WAR * OPS)))
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269 + 0.215630*FreeAgencyOPS_Results$WAR - 0.022076*FreeAgencyOPS_Results$AGE + 0.008152*FreeAgencyOPS_Results$H - 6.927712*FreeAgencyOPS_Results$AVG + 3.627472*FreeAgencyOPS_Results$OPS - 0.0018766*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$H) - 0.008076*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$HR) - 0.0028382*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$RBI))
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
# Average Error
mean(FreeAgencyOPS_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Error)
# Average Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Difference)
# OPS
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (H Coefficient * H) + (AVG Coefficient * AVG) + (OPS Coefficient * OPS) + (WAR:H Moderation Coefficient * (WAR * H)) + (WAR:OPS Moderation Coefficient * (WAR * OPS)))
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269 + 0.215630*FreeAgencyOPS_Results$WAR - 0.022076*FreeAgencyOPS_Results$AGE + 0.008152*FreeAgencyOPS_Results$H - 6.927712*FreeAgencyOPS_Results$AVG + 3.627472*FreeAgencyOPS_Results$OPS)
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
# Average Error
mean(FreeAgencyOPS_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Error)
# Average Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Difference)
# Moderator(OPS) IV(WAR) DV(AVG. SALARY)
moderation_model_OPS_OPS <- lm(log(`AVG. SALARY`) ~ WAR * OPS, data = FreeAgencyOPS)
summary(moderation_model_OPS_OPS)
# OPS
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (H Coefficient * H) + (AVG Coefficient * AVG) + (OPS Coefficient * OPS) + (WAR:H Moderation Coefficient * (WAR * H)))
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269 + 0.215630*FreeAgencyOPS_Results$WAR - 0.022076*FreeAgencyOPS_Results$AGE + 0.008152*FreeAgencyOPS_Results$H - 6.927712*FreeAgencyOPS_Results$AVG + 3.627472*FreeAgencyOPS_Results$OPS - 0.0018766*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$H))
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
# Average Error
mean(FreeAgencyOPS_Results$Model_Error)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Error)
# Average Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Difference)
# Creating a Model
# ERA
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (IP Coefficient * IP) + (ERA Coefficient * ERA) + (WHIP Coefficient * WHIP) + (W Coefficient * W) + (SV Coefficient * SV) + (WAR:IP Moderation Coefficient * (WAR * IP)) + (WAR:W Moderation Coefficient * (WAR * W)))
FreeAgencyERA_Results$Predicted_Salary <- exp(16.064277 +  0.154367*FreeAgencyERA_Results$WAR - 0.023938*FreeAgencyERA_Results$AGE + 0.004216*FreeAgencyERA_Results$IP + 0.045483*FreeAgencyERA_Results$ERA - 0.721570*FreeAgencyERA_Results$WHIP + 0.054429*FreeAgencyERA_Results$W + 0.025936*FreeAgencyERA_Results$SV - 0.0012974*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$IP) - 0.01393*(FreeAgencyERA_Results$WAR * FreeAgencyERA_Results$W))
# Percent Error = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyERA_Results$Model_Error <- ((FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary)/FreeAgencyERA_Results$`AVG. SALARY`)
# Average Error
mean(FreeAgencyERA_Results$Model_Error)
# -.1343679 = -13.44%
# Standard Deviation of Error
sd(FreeAgencyERA_Results$Model_Error)
# 1.051311
summary(FreeAgencyERA_Results$Model_Error)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyERA_Results$Model_Difference <- abs(FreeAgencyERA_Results$`AVG. SALARY` - FreeAgencyERA_Results$Predicted_Salary) / ((FreeAgencyERA_Results$Predicted_Salary + FreeAgencyERA_Results$`AVG. SALARY`)/2)
# Average Difference
mean(FreeAgencyERA_Results$Model_Difference)
# .6486968 = 65%
# Standard Deviation of Difference
sd(FreeAgencyERA_Results$Model_Difference)
# .4261189
summary(FreeAgencyERA_Results$Model_Difference)
# OPS
# Salary = exp(Intercept + (WAR Coefficient * WAR) + (AGE Coefficient * AGE) + (H Coefficient * H) + (AVG Coefficient * AVG) + (OPS Coefficient * OPS) + (WAR:H Moderation Coefficient * (WAR * H)))
FreeAgencyOPS_Results$Predicted_Salary <- exp(14.125269 + 0.215630*FreeAgencyOPS_Results$WAR - 0.022076*FreeAgencyOPS_Results$AGE + 0.008152*FreeAgencyOPS_Results$H - 6.927712*FreeAgencyOPS_Results$AVG + 3.627472*FreeAgencyOPS_Results$OPS - 0.0018766*(FreeAgencyOPS_Results$WAR * FreeAgencyOPS_Results$H))
# Percent Change = ((Predicted - AVG.SALARY)/AVG. SALARY)
FreeAgencyOPS_Results$Model_Error <- ((FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary)/FreeAgencyOPS_Results$`AVG. SALARY`)
# Percent Difference = |Predicted – Observed|/[(Predicted + Observed)/2]
FreeAgencyOPS_Results$Model_Difference <- abs(FreeAgencyOPS_Results$`AVG. SALARY` - FreeAgencyOPS_Results$Predicted_Salary) / ((FreeAgencyOPS_Results$Predicted_Salary + FreeAgencyOPS_Results$`AVG. SALARY`)/2)
# Average Error
mean(FreeAgencyOPS_Results$Model_Error)
# -.0874656 = -8.75%
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Error)
# .9736621
# Average Difference
mean(FreeAgencyOPS_Results$Model_Difference)
# .6596408 = 66%
# Standard Deviation of Error
sd(FreeAgencyOPS_Results$Model_Difference)
# .4149471
summary(FreeAgencyOPS_Results$Model_Error)
summary(FreeAgencyOPS_Results$Model_Difference)
write.csv(FreeAgencyERA_Results, "FreeAgencyERA_Results.csv", row.names = FALSE)
write.csv(FreeAgencyOPS_Results, "FreeAgencyOPS_Results.csv", row.names = FALSE)
