FreeAgency <- FreeAgency %>%
mutate(contract_value = str_extract(contract_information, "\\$[0-9.]+ million") %>%
gsub("\\$| million", "", .) %>%
as.numeric(),
dummy_code = case_when(
contract_value < 4 ~ 1,    # Low
contract_value == 4 ~ 2,   # Median
contract_value > 4 ~ 3,    # High
TRUE ~ NA_integer_
))
FreeAgency <- FreeAgency %>%
mutate(contract_value = str_extract(TERMS, "\\$[0-9.]+ million") %>%
gsub("\\$| million", "", .) %>%
as.numeric(),
dummy_code = case_when(
contract_value < 4 ~ 1,    # Low
contract_value == 4 ~ 2,   # Median
contract_value > 4 ~ 3,    # High
TRUE ~ NA_integer_
))
FreeAgency <- FreeAgency %>%
mutate(contract_value = str_extract(TERMS, "\\$[0-9.]+ million") %>%
gsub("\\$| million", "", .) %>%
as.numeric(),
dummy_value = case_when(
contract_value < 4 ~ 1,    # Low
contract_value == 4 ~ 2,   # Median
contract_value > 4 ~ 3,    # High
TRUE ~ NA_integer_
))
FreeAgency <- FreeAgency %>% select(-dummy_code)
# Save all Data
write.csv(FreeAgency, "FreeAgency.csv", row.names = FALSE)
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(contract_value = as.numeric(gsub("\\$|,", "", BaseSalary)),
dummy_salary = case_when(
contract_value < 4e6 ~ 1,    # Low
contract_value == 4e6 ~ 2,   # Median
contract_value > 4e6 ~ 3,    # High
TRUE ~ NA_integer_
))
BaseSalaries2023 <- BaseSalaries2023 %>%
mutate(contract_value = as.numeric(gsub("\\$|,", "", BaseSalary)),
dummy_salary = case_when(
contract_value < 4e6 ~ 1,    # Low
contract_value == 4e6 ~ 2,   # Median
contract_value > 4e6 ~ 3,    # High
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age, < 26 ~ 1,
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 26 ~ 1,
between(Age, 26, 34)  ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 25 ~ 1,
between(Age, 26, 34)  ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
age < 25 ~ 1,
between(age, 26, 34) ~ 2,
age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
library(dplyr)
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = as.character(case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
)))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = as.numeric(case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
)))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
age < 25 ~ 1,
between(age, 26, 34) ~ 2,
age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022$Age <- as.numeric(BaseSalaries2022$Age)
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age <= 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age >= 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2023$Age <- as.numeric(BaseSalaries2023$Age)
BaseSalaries2023 <- BaseSalaries2023 %>%
mutate(dummy_age = case_when(
Age <= 25 ~ 1,
between(Age, 26, 34) ~ 2,
Age >= 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2023 <- BaseSalaries2023 %>%
mutate(dummy_Pos = case_when(
Pos %in% c("RP", "SP", "P", "RP/CL", "CL", "SP/DH") ~ 1,
Pos %in% c("C", "1B", "2B", "3B", "SS") ~ 2,
Pos %in% c("LF", "CF", "RF", "OF") ~ 3,
Pos %in% c("DH") ~ 4,
TRUE ~ NA_integer_
))
PlayerIDs <- read.csv("~/Data Science/DiamondDeals/Wrangled Data/PlayerIDs.csv")
View(PlayerIDs)
# Save all Data
write.csv(PlayerIDs, "PlayerIDs.csv", row.names = FALSE)
write.csv(FreeAgency, "FreeAgency.csv", row.names = FALSE)
write.csv(combinedBattingDataset, "combinedBattingDataset.csv", row.names = FALSE)
write.csv(BattingDataset2021, "BattingDataset2021.csv", row.names = FALSE)
write.csv(BattingDataset2022, "BattingDataset2022.csv", row.names = FALSE)
write.csv(combinedPitchingDataset, "combinedPitchingDataset.csv", row.names = FALSE)
write.csv(PitchingDataset2021, "PitchingDataset2021.csv", row.names = FALSE)
write.csv(PitchingDataset2022, "PitchingDataset2022.csv", row.names = FALSE)
write.csv(BaseSalaries2022, "BaseSalaries2022.csv", row.names = FALSE)
write.csv(BaseSalaries2023, "BaseSalaries2023.csv", row.names = FALSE)
write.csv(combinedPitchingDataset, "combinedPitchingDataset.csv", row.names = FALSE)
combinedPitchingDataset <- read.csv("~/Data Science/DiamondDeals/Wrangled Data/combinedPitchingDataset.csv")
View(combinedPitchingDataset)
write.csv(combinedPitchingDataset, "combinedPitchingDataset.csv", row.names = FALSE)
# Create a Master Sheet
master_dataset <- PlayerIDs %>%
left_join(BattingDataset2021, by = "PlayerID") %>%
left_join(BattingDataset2022, by = "PlayerID") %>%
left_join(PitchingDataset2021, by = "PlayerID") %>%
left_join(PitchingDataset2022, by = "PlayerID") %>%
left_join(BaseSalaries2022, by = "PlayerID") %>%
left_join(BaseSalaries2023, by = "PlayerID") %>%
left_join(FreeAgency, by = "PlayerID")
View(BaseSalaries2023)
BaseSalaries2022$PlayerID <- as.numeric(BaseSalaries2022$PlayerID)
BaseSalaries2023$PlayerID <- as.numeric(BaseSalaries2023$PlayerID)
BattingDataset2021$PlayerID <- as.numeric(BattingDataset2021$PlayerID)
BattingDataset2022$PlayerID <- as.numeric(BattingDataset2022$PlayerID)
combinedBattingDataset$PlayerID <- as.numeric(combinedBattingDataset$PlayerID)
combinedPitchingDataset$PlayerID <- as.numeric(combinedPitchingDataset$PlayerID)
FreeAgency$PlayerID <- as.numeric(FreeAgency$PlayerID)
View(PlayerIDs)
View(PitchingDataset2021)
View(PitchingDataset2021)
View(PitchingDataset2022)
View(FreeAgency)
FreeAgency <- FreeAgency %>% rename(Player = Name)
FreeAgency <- FreeAgency %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
FreeAgency <- FreeAgency %>% select(PlayerID, everything())
View(combinedPitchingDataset)
View(combinedBattingDataset)
FreeAgency$PlayerID <- as.numeric(FreeAgency$PlayerID)
View(BattingDataset2022)
View(BattingDataset2021)
View(BaseSalaries2023)
View(BaseSalaries2022)
write.csv(PlayerIDs, "PlayerIDs.csv", row.names = FALSE)
write.csv(FreeAgency, "FreeAgency.csv", row.names = FALSE)
write.csv(combinedBattingDataset, "combinedBattingDataset.csv", row.names = FALSE)
write.csv(BattingDataset2021, "BattingDataset2021.csv", row.names = FALSE)
write.csv(BattingDataset2022, "BattingDataset2022.csv", row.names = FALSE)
write.csv(combinedPitchingDataset, "combinedPitchingDataset.csv", row.names = FALSE)
write.csv(PitchingDataset2021, "PitchingDataset2021.csv", row.names = FALSE)
write.csv(PitchingDataset2022, "PitchingDataset2022.csv", row.names = FALSE)
write.csv(BaseSalaries2022, "BaseSalaries2022.csv", row.names = FALSE)
write.csv(BaseSalaries2023, "BaseSalaries2023.csv", row.names = FALSE)
FreeAgency <- read.csv("~/Data Science/DiamondDeals/Wrangled Data/FreeAgency.csv")
View(FreeAgency)
FreeAgency <- FreeAgency %>% select(PlayerID, everything())
FreeAgency <- FreeAgency %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
FreeAgency <- FreeAgency %>% select(-PlayerID.x)
FreeAgency <- FreeAgency %>% select(-PlayerID.y)
FreeAgency <- FreeAgency %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
FreeAgency <- FreeAgency %>% select(PlayerID, everything())
FreeAgency$PlayerID <- as.numeric(FreeAgency$PlayerID)
write.csv(FreeAgency, "FreeAgency.csv", row.names = FALSE)
master_dataset <- PlayerIDs %>%
left_join(BattingDataset2021, by = "PlayerID") %>%
left_join(BattingDataset2022, by = "PlayerID") %>%
left_join(PitchingDataset2021, by = "PlayerID") %>%
left_join(PitchingDataset2022, by = "PlayerID") %>%
left_join(BaseSalaries2022, by = "PlayerID") %>%
left_join(BaseSalaries2023, by = "PlayerID") %>%
left_join(FreeAgency, by = "PlayerID")
View(finalStatHeadBatting)
View(master_dataset)
View(master_dataset)
write.csv(master_dataset, "master_data.csv", row.names = FALSE)
Free.Agency.2022 <- read.csv("~/Data Science/DiamondDeals/Free Agency 2022.csv", comment.char="#")
View(Free.Agency.2022)
View(PitchingDataset2021)
Free.Agency.2022 <- read.csv("~/Data Science/DiamondDeals/Free Agency 2022.csv")
View(Free.Agency.2022)
FreeAgency.2002<- FreeAgency.2002 %>%
left_join(PlayerIDs %>% select(PlayerID, PLAYER), by = "Player")
Free.Agency.2002<- Free.Agency.2002 %>%
left_join(PlayerIDs %>% select(PlayerID, PLAYER), by = "Player")
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, PLAYER), by = "Player")
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "PLAYER")
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, PLAYER), by = "PLAYER")
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "PLAYER")
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2022 <- Free.Agency.2022 %>% rename(Player = PLAYER)
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2022 <- Free.Agency.2022 %>% select(PlayerID, everything())
write.csv(Free.Agency.2022, "Free.Agency.2022.csv", row.names = FALSE)
Free.Agency.2022 <- read.csv("~/Data Science/DiamondDeals/Free.Agency.2022.csv")
View(Free.Agency.2022)
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2022 <- Free.Agency.2022 %>% select(-PlayerID.x, -PlayerID.y)
Free.Agency.2022<- Free.Agency.2022 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2022 <- Free.Agency.2022 %>% select(PlayerID, everything())
write.csv(Free.Agency.2022, "Free.Agency.2022.csv", row.names = FALSE)
Free.Agency.2023 <- read.csv("~/Data Science/DiamondDeals/Free Agency 2023.csv", comment.char="#")
View(Free.Agency.2023)
Free.Agency.2023 <- Free.Agency.2023 %>% rename(Player = PLAYER)
Free.Agency.2023<- Free.Agency.2023 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
write.csv(Free.Agency.2023, "Free.Agency.2023.csv", row.names = FALSE)
Free.Agency.2023 <- read.csv("~/Data Science/DiamondDeals/Free.Agency.2023.csv")
View(Free.Agency.2023)
Free.Agency.2023<- Free.Agency.2023 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2023 <- read.csv("~/Data Science/DiamondDeals/Free.Agency.2023.csv")
View(Free.Agency.2023)
Free.Agency.2023<- Free.Agency.2023 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2023 <- Free.Agency.2023 %>% select(-PlayerID.x, -PlayerID.y)
Free.Agency.2023<- Free.Agency.2023 %>%
left_join(PlayerIDs %>% select(PlayerID, Player), by = "Player")
Free.Agency.2023 <- Free.Agency.2023 %>% select(PlayerID, everything())
write.csv(Free.Agency.2023, "Free.Agency.2023.csv", row.names = FALSE)
#free agency dataset
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Pos = case_when(
POS. %in% c("RP", "SP", "P") ~ 1,
POS. %in% c("C", "1B", "2B", "3B", "SS") ~ 2,
POS. %in% c("LF", "CF", "RF", "OF") ~ 3,
POS. %in% c("DH") ~ 4,
TRUE ~ NA_integer_
))
Free.Agency.2023 <- Free.Agency.2023 %>%
mutate(dummy_Pos = case_when(
POS. %in% c("RP", "SP", "P") ~ 1,
POS. %in% c("C", "1B", "2B", "3B", "SS") ~ 2,
POS. %in% c("LF", "CF", "RF", "OF") ~ 3,
POS. %in% c("DH") ~ 4,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Years = case_when(
YRS == 1 ~ 1,
YRS >= 2 ~ 2,
TRUE ~ NA_integer_
))
Free.Agency.2023 <- Free.Agency.2023 %>%
mutate(dummy_Years = case_when(
YRS == 1 ~ 1,
YRS >= 2 ~ 2,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Salary = case_when(
AVG..SALARY < 4e6 ~ 1,
between(AVG..SALARY, 4e6, 5e6 ~ 2),
AVG..SALARY > 5e6 ~ 3,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(as.numeric(gsub("\\$|,", "", BaseSalary)),
dummy_Salary = case_when(
AVG..SALARY < 4e6 ~ 1,
between(AVG..SALARY, 4e6, 5e6 ~ 2),
AVG..SALARY > 5e6 ~ 3,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(as.numeric(gsub("\\$|,", "", Free.Agency.2022)),
dummy_Salary = case_when(
AVG..SALARY < 4e6 ~ 1,
between(AVG..SALARY, 4e6, 5e6 ~ 2),
AVG..SALARY > 5e6 ~ 3,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Salary = case_when(
AVG..SALARY < 4000000 ~ 1,
between(AVG..SALARY, 4000000, 5000000 ~ 2),
AVG..SALARY > 5000000 ~ 3,
is.na(AVG..SALARY) ~ NA_integer_,
TRUE ~ NA_integer_
))
Free.Agency.2022$AVG..SALARY <- as.numeric(gsub("[^0-9]", "", as.character(Free.Agency.2022$AVG..SALARY)))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Salary = case_when(
AVG..SALARY < 4000000 ~ 1,
between(AVG..SALARY, 4000000, 5000000 ~ 2),
AVG..SALARY > 5000000 ~ 3,
is.na(AVG..SALARY) ~ NA_integer_,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(contract_value = as.numeric(gsub("\\$|,", "", AVG..SALARY)),
dummy_salary = case_when(
contract_value < 4e6 ~ 1,    # Low
contract_value == 4e6 ~ 2,   # Median
contract_value > 4e6 ~ 3,    # High
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(contract_value = as.numeric(gsub("\\$|,", "", AVG..SALARY)),
dummy_salary = case_when(
contract_value < 4e6 ~ 1,    # Low
between(contract_value, 4e6, 5e6 ~ 2),   # Median
contract_value > 5e6 ~ 3,    # High
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(contract_value = as.numeric(gsub("\\$|,", "", AVG..SALARY)),
dummy_salary = case_when(
contract_value < 4e6 ~ 1,    # Low
between(contract_value, 4e6, 5e6) ~ 2,   # Median
contract_value > 5e6 ~ 3,    # High
TRUE ~ NA_integer_
))
Free.Agency.2023 <- Free.Agency.2023 %>%
mutate(contract_value = as.numeric(gsub("\\$|,", "", AVG..SALARY)),
dummy_salary = case_when(
contract_value < 4e6 ~ 1,    # Low
between(contract_value, 4e6, 5e6) ~ 2,   # Median
contract_value > 5e6 ~ 3,    # High
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Age = case_when(
AGE <= 25 ~ 1,
between(AGE, 26, 34) ~ 2,
AGE >= 35 ~ 3,
TRUE ~ NA_integer_
))
BaseSalaries2022 <- BaseSalaries2022 %>%
mutate(dummy_age = case_when(
Age < 26 ~ 1,
between(Age, 26, 34) ~ 2,
Age > 34 ~ 3,
TRUE ~ NA_integer_
))
Free.Agency.2022 <- Free.Agency.2022 %>%
mutate(dummy_Age = case_when(
AGE < 26 ~ 1,
between(AGE, 26, 34) ~ 2,
AGE > 34 ~ 3,
TRUE ~ NA_integer_
))
Free.Agency.2023 <- Free.Agency.2023 %>%
mutate(dummy_Age = case_when(
AGE < 26 ~ 1,
between(AGE, 26, 34) ~ 2,
AGE > 34 ~ 3,
TRUE ~ NA_integer_
))
write.csv(Free.Agency.2022, "Free.Agency.2022.csv", row.names = FALSE)
write.csv(Free.Agency.2023, "Free.Agency.2023.csv", row.names = FALSE)
#install.packages("nnet")
library(nnet)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model <- multinom(dummy_Pos ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model <- multinom(POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model <- multinom(dummy_Pos ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model <- multinom(POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
initial_model <- multinom(YRS ~ ERA + OPS + WAR, data = Free.Agency.2022)
initial_model <- multinom(AVG..SALARY ~ ERA + OPS + WAR, data = Free.Agency.2022)
initial_model <- multinom(AGE ~ ERA + OPS + WAR, data = Free.Agency.2022)
final_model_position <- step(initial_model_position, direction = "both")
# Perform stepwise model selection
#final_model <- step(initial_model, direction = "both")
final_model_position <- step(initial_model_position, direction = "both")
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model <- multinom(POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_postion <- multinom(POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
initial_model_contract <- multinom(YRS ~ ERA + OPS + WAR, data = Free.Agency.2022)
initial_model_salary <- multinom(AVG..SALARY ~ ERA + OPS + WAR, data = Free.Agency.2022)
initial_model_age <- multinom(AGE ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Perform stepwise model selection
#final_model <- step(initial_model, direction = "both")
final_model_position <- step(initial_model_position, direction = "both")
final_model_contract <- step(initial_model_contract, direction = "both")
final_model_salary <- step(initial_model_salary, direction = "both")
final_model_age <- step(initial_model_age, direction = "both")
# View the final model summary
#summary(final_model)
summary(final_model_position)
summary(final_model_contract)
summary(final_model_salary)
summary(final_model_age)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_postion <- multinom(POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Perform stepwise model selection
#final_model <- step(initial_model, direction = "both")
final_model_position <- step(initial_model_position, direction = "both")
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom(POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Perform stepwise model selection
#final_model <- step(initial_model, direction = "both")
final_model_position <- step(initial_model_position, direction = "both")
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom(dummy_Pos ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom("dummy_Pos" ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom(Free.Agency.2022$dummy_Pos ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom(Free.Agency.2022$POS. ~ ERA + OPS + WAR, data = Free.Agency.2022)
# Perform stepwise model selection
#final_model <- step(initial_model, direction = "both")
final_model_position <- step(initial_model_position, direction = "both")
initial_model_age <- multinom(AGE ~ ERA + OPS + WAR, data = Free.Agency.2022)
final_model_age <- step(initial_model_age, direction = "both")
summary(final_model_age)
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom(dummy_Pos ~ ERA + OPS + WAR, data = Free.Agency.2022)
table(Free.Agency.2022$dummy_Pos)
levels(Free.Agency.2022$dummy_Pos)
Free.Agency.2022$dummy_Pos <- factor(Free.Agency.2022$dummy_Pos, levels = c("P", "IF", "OF", "DH"))
levels(Free.Agency.2022$dummy_Pos)
sum(is.na(Free.Agency.2022$dummy_Pos))
# Fit the initial model
#initial_model <- multinom(response ~ predictor1 + predictor2 + predictor3, data = your_data)
initial_model_position <- multinom(dummy_Pos ~ ERA + OPS + WAR, data = Free.Agency.2022)
table(Free.Agency.2022$POS.)
levels(Free.Agency.2022$POS.)
Free.Agency.2022$dummy_Pos <- factor(Free.Agency.2022$dummy_Pos, levels = c("1", "2", "3", "4"))
table(Free.Agency.2022$dummy_Pos)
levels(Free.Agency.2022$dummy_Pos)
sum(is.na(Free.Agency.2022$dummy_Pos))
